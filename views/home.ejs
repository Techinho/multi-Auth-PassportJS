<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Multi-Auth Demo</title>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
        <style>
            body {
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
                margin: 0;
                background-color: #f8fafc;
                color: #1e293b;
                line-height: 1.6;
            }
            nav {
                background: #2563eb;
                padding: 1rem;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            nav ul {
                max-width: 1200px;
                margin: 0 auto;
                padding: 0;
                display: flex;
                align-items: center;
            }
            nav li {
                list-style-type: none;
                display: inline-block;
                margin: 0 1rem 0 0;
            }
            nav a {
                color: #fff;
                font-size: 1rem;
                font-weight: 500;
                background: rgba(255,255,255,0.1);
                text-decoration: none;
                padding: 0.75rem 1.25rem;
                border-radius: 0.5rem;
                transition: all 0.2s ease;
            }
            nav a:hover {
                background: rgba(255,255,255,0.2);
                transform: translateY(-1px);
            }
            main, header {
                max-width: 1200px;
                margin: 2rem auto;
                padding: 0 1rem;
            }
            h1, h2, h3 {
                color: #1e293b;
                font-weight: 700;
            }
            p {
                color: #475569;
            }
            .card {
                background: white;
                border-radius: 1rem;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                padding: 2rem;
                margin-bottom: 2rem;
                border: 1px solid #e2e8f0;
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            .card:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            }
            .hero {
                text-align: center;
                padding: 4rem 0;
            }
            .hero h1 {
                font-size: 3rem;
                margin-bottom: 1rem;
            }
            .hero p {
                font-size: 1.25rem;
                max-width: 600px;
                margin: 0 auto 2rem auto;
            }
            .btn {
                display: inline-block;
                padding: 0.75rem 1.5rem;
                font-weight: 600;
                text-decoration: none;
                border-radius: 0.5rem;
                transition: all 0.2s;
            }
            .btn-primary {
                background-color: #2563eb;
                color: white;
            }
            .btn-primary:hover {
                background-color: #1d4ed8;
            }
            .features {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 2rem;
                margin: 4rem 0;
            }
            .auth-options {
                display: flex;
                justify-content: center;
                gap: 1rem;
                margin-top: 1rem;
            }
            .btn-oauth {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 0.5rem;
                padding: 0.75rem 1.5rem;
                border-radius: 0.5rem;
                transition: all 0.2s;
                text-decoration: none;
                font-weight: 600;
            }
            .btn-google {
                background-color: #ffffff;
                color: #1e293b;
                border: 1px solid #e2e8f0;
            }
            .btn-github {
                background-color: #333;
                color: white;
            }
            .btn-form {
                background-color: #10b981;
                color: white;
            }
        </style>
    </head>
    <body>
        <nav>
            <ul>
                <li><a href="/">Multi-Auth Demo</a></li>
                <li id="profileLink" style="margin-left: auto; display: none;"><a href="/profile">Profile</a></li>
                <li id="loginLink" style="margin-left: auto;"><a href="/auth/login">Login</a></li>
                <li id="registerLink"><a href="/auth/register">Register</a></li>
                <li id="logoutLink" style="display: none;"><a href="#" id="logoutBtn">Logout</a></li>
            </ul>
        </nav>

        <main>
            <section class="hero">
                <h1>Welcome to Multi-Auth Demo</h1>
                <p>A demonstration of multiple authentication strategies with JWT, Google OAuth, and GitHub OAuth.</p>
                
                <div id="guestContent">
                    <a href="/auth/login" class="btn btn-primary">Login Now</a>
                    <p>or sign in with:</p>
                    <div class="auth-options">
                        <a href="/auth/google" class="btn-oauth btn-google">
                            <svg width="18" height="18" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path fill="#4285F4" d="M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"/>
                            </svg>
                            Google
                        </a>
                        <a href="/auth/github" class="btn-oauth btn-github">
                            <svg width="18" height="18" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path fill="#fff" d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                            GitHub
                        </a>
                        <a href="/auth/register" class="btn-oauth btn-form">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/>
                            </svg>
                            Register
                        </a>
                    </div>
                </div>
                
                <div id="userContent" style="display: none;">
                    <a href="/profile" class="btn btn-primary">View Your Profile</a>
                    <p>Welcome back! <span id="userGreeting"></span></p>
                </div>
            </section>

            <div class="features">
                <div class="card">
                    <h2>Multiple Authentication Methods</h2>
                    <p>Choose from JWT-based authentication, Google OAuth, or GitHub OAuth to secure your application.</p>
                </div>
                
                <div class="card">
                    <h2>User Profiles</h2>
                    <p>Access user profile information from various providers to personalize your application experience.</p>
                </div>
                
                <div class="card">
                    <h2>JWT Integration</h2>
                    <p>Uses JWT tokens for stateless authentication with modern security practices.</p>
                </div>
            </div>
        </main>

        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const token = localStorage.getItem('token');
                const logoutBtn = document.getElementById('logoutBtn');
                
                // Check if user is logged in
                if (token) {
                    // Show logged in UI
                    document.getElementById('profileLink').style.display = 'inline-block';
                    document.getElementById('logoutLink').style.display = 'inline-block';
                    document.getElementById('loginLink').style.display = 'none';
                    document.getElementById('registerLink').style.display = 'none';
                    document.getElementById('userContent').style.display = 'block';
                    document.getElementById('guestContent').style.display = 'none';
                    
                    // Get user data for greeting
                    fetch('/auth/profile', {
                        headers: {
                            'Authorization': token.startsWith('Bearer ') ? token : `Bearer ${token}`
                        }
                    })
                    .then(res => {
                        if (res.ok) return res.json();
                        throw new Error('Failed to fetch profile');
                    })
                    .then(data => {
                        document.getElementById('userGreeting').textContent = data.user.username || data.user.email.split('@')[0];
                    })
                    .catch(err => {
                        console.error('Error fetching profile:', err);
                    });
                    
                    // Handle logout
                    logoutBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        localStorage.removeItem('token');
                        window.location.href = '/';
                    });
                } else {
                    // Show guest UI
                    document.getElementById('profileLink').style.display = 'none';
                    document.getElementById('logoutLink').style.display = 'none';
                    document.getElementById('loginLink').style.display = 'inline-block';
                    document.getElementById('registerLink').style.display = 'inline-block';
                    document.getElementById('userContent').style.display = 'none';
                    document.getElementById('guestContent').style.display = 'block';
                }
            });
        </script>
    </body>
</html>
